<html>
	<head>
		<meta charset="utf-8">
	</head>
	<body onLoad="init()">
		<canvas id="canvas" width="600" height="400" style="border: 1px solid;"></canvas>
		<script>
			//// --------------- Layer Class --------------- ////
			var Layer = function(src, order, cvX, cvY, cvW, cvH){
				this.image = new Image();
				this.image.src = src;
				this.image.addEventListener('load', function(){
						if(loadedCount == layers.length){
							drawLayers();
						}
						loadedCount++;
					}, false);
				this.order = order;
				this.cvX = cvX;
				this.cvY = cvY;
				this.cvW = cvW;
				this.cvH = cvH;
			};
			Layer.prototype.draw = function() {
				console.log('draw() ' + this.image.src + ' x:'+this.cvX + ' y:'+this.cvY + ' w:'+this.cvW + ' h:'+this.cvH);
				context.drawImage(this.image, this.cvX, this.cvY, this.cvW, this.cvH);
			};

			var drawLayers = function(){
				for(var i in layers){
					layers[i].draw();
				}
			};

			var loadedCount = 1;
			var canvas = document.getElementById('canvas');
			var context = canvas.getContext('2d');
			var layers = [];

			var init = function(){
				var srcs = [
					'1.png',
					'2.png',
					'3.png',
					'4.png',
				];
				var x = 0;
				var y = 0;
				var w = 150;
				var h = 100;
				for(var i in srcs){
					layers[i] = new Layer(srcs[i], i, x, y, w, h);
					x += 50;
					y += 70;
				}
			};
		</script>
	</body>
</html>
